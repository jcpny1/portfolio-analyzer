(this["webpackJsonpportfolio-analyzer"]=this["webpackJsonpportfolio-analyzer"]||[]).push([[0],{214:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"portfolioAdd",(function(){return ve})),n.d(r,"portfolioDelete",(function(){return xe})),n.d(r,"portfoliosLoad",(function(){return Ce})),n.d(r,"portfoliosSort",(function(){return ke})),n.d(r,"portfolioUpdate",(function(){return we}));var o={};n.r(o),n.d(o,"positionAdd",(function(){return Ke})),n.d(o,"positionDelete",(function(){return Ze})),n.d(o,"positionsSort",(function(){return et})),n.d(o,"positionUpdate",(function(){return tt}));var i={};n.r(i),n.d(i,"userLoad",(function(){return dt})),n.d(i,"userUpdate",(function(){return ht}));var a=n(1),s=n(0),c=n(49),l=n.n(c),u=(n(214),n(9)),d=n(11),h=n(14),p=n(13),f=n(24),j=n(99),b=n(15),m=n(238),g=n(246),O=n(241),y=n(183),v=n(182),x=n(240),C=n(245),k=n(101),w=n(237),S=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).handleCancel=function(){r.setState({open:!1})},r.handleConfirm=function(){r.setState({open:!1}),r.props.onClickConfirm()},r.show=function(){!r.props.disabled&&r.setState({open:!0})},r.state={open:!1},r}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.color,n=e.disabled,r=e.header,o=e.name,i=e.title,s=e.triggerType,c=this.state.open;return Object(a.jsxs)("span",{children:["icon"===s?Object(a.jsx)(k.a,{name:o,title:i,id:"portfolioDelete",link:!0,color:t,onClick:this.show}):Object(a.jsx)(m.a.Item,{disabled:n,text:i,onClick:this.show}),Object(a.jsx)(w.a,{cancelButton:"NO",confirmButton:"YES",closeOnDimmerClick:!1,header:r,open:c,onCancel:this.handleCancel,onConfirm:this.handleConfirm})]})}}]),n}(s.Component),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"decimal",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(u.a)(this,e);var o=Number.parseFloat(t);this._value=-0===Math.sign(o)?0:o,this._type=n,this._delta=r}return Object(d.a)(e,[{key:"valueOf",value:function(){return this._value}},{key:"toHTML",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.toString(e),r="black",o="";return t?r=t:this._value<0?r="red":this._value>0&&this._delta&&(r="green",o="+"),Object(a.jsxs)("span",{style:{color:r},children:[o,n]})}},{key:"toString",value:function(e){var t="";return this._value&&(t=e?this.toStringFormatted(e):this._value.toString()),t}},{key:"toStringFormatted",value:function(e){var t={};switch(this._type){case"currency":t.style="currency",t.currency="USD",t.minimumFractionDigits=2,t.maximumFractionDigits=3;break;case"decimal":t.minimumFractionDigits=2,t.maximumFractionDigits=3;break;case"index":t.minimumFractionDigits=0,t.maximumFractionDigits=2;break;case"percent":t.style="percent",t.minimumFractionDigits=0,t.maximumFractionDigits=2;break;case"quantity":t.minimumFractionDigits=0,t.maximumFractionDigits=5}return this._value.toLocaleString(e,t)}}],[{key:"fromLocale",value:function(e,t){var n=new Intl.NumberFormat(t).format(1000.1),r=n[1],o=n[5],i=new RegExp("(d+)([".concat(r).concat(o,"])"),"g");return e.replace(i,(function(e,t,n){var i=n===r?"":n===o?".":n;return"".concat(t).concat(i)}))}}]),e}(),_={serverError:function(e,t){var n=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(Date.now()),r=400===t.status||500===t.status?"".concat(e,": status: ").concat(t.status," error: ").concat(t.error,": ").concat(t.exception," @ ").concat(t.traces["Application Trace"][0].trace):"".concat(e,": ").concat(t);return"".concat(r,"\n\n\n").concat(n)},truncate:function(e,t){return e.length>t?e.substr(0,t-1)+"...":e},valueColor:function(e){var t="black",n=Math.sign(Number.parseFloat(e));return 1===n?t="green":-1===n&&(t="red"),t}},T=function(e){var t=e.articles,n=e.djiaValue,r=e.djiaChange,o=e.refreshHeadlines,i=e.refreshTime,s=e.userLocale;return Object(a.jsxs)("span",{children:[Object(a.jsxs)(C.a,{size:"medium",color:"purple",style:{marginBottom:0,marginLeft:"3px"},children:["Headline News",Object(a.jsxs)("span",{disabled:!0,style:{float:"right",fontSize:"70%"},children:[Object(a.jsxs)(C.a,{as:"span",title:"Dow Jones Industrial Average",size:"tiny",color:"purple",children:["DJIA\xa0\xa0",n.toHTML(s,"purple"),"\xa0\xa0",r.toHTML(s)]}),"\u2003\u2003\u2003",Object(a.jsxs)(C.a,{as:"span",title:"Last index refresh time",size:"tiny",color:"purple",children:["Time\xa0\xa0",i.toLocaleTimeString(s)]}),"\u2003\u2003\u2003",Object(a.jsx)(y.a,{disabled:!0,content:"Refresh: Auto",icon:"refresh",title:"Refresh headlines",compact:!0,inverted:!0,size:"tiny",style:{paddingRight:"3px",color:"purple"},onClick:function(){return o()}})]})]}),Object(a.jsx)(O.a,{compact:!0,sortable:!0,striped:!0,style:{marginTop:0},children:Object(a.jsx)(O.a.Body,{children:t?t.map((function(e,t){return Object(a.jsx)(O.a.Row,{children:Object(a.jsx)(O.a.Cell,{children:Object(a.jsx)("a",{className:"news",href:e.url,title:e.description,target:"_blank",rel:"noopener noreferrer",children:Object(a.jsxs)("span",{style:{fontWeight:e.fontWeight},children:[e.title,"."]})})})},t)})):null})})]})},D=(n(164),function e(){Object(u.a)(this,e)});function E(e,t){var n=e.exact?"&exact":"",r=encodeURIComponent(e.value);return fetch("/api/instruments?v=".concat(r).concat(n),{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then(t).catch((function(e){alert(e.message)}))}function L(){fetch("/api/instruments/refresh",{headers:{Accept:"application/json"}}).then(F).catch((function(e){alert(_.serverError("Refresh Symbols",e))}))}function H(){fetch("/api/trades/refresh",{headers:{Accept:"application/json"}}).then(F).catch((function(e){alert(_.serverError("Refresh Prices",e))}))}function P(e){fetch("/api/series/refresh?instruments=".concat(e,"&symbols=").concat(D.ETF_SYMBOLS),{headers:{Accept:"application/json"}}).then(F).catch((function(e){alert(_.serverError("Refresh Prices",e))}))}function R(){P("active")}function I(){P("all")}function F(e){if(e.status<200||e.status>=300){var t=new Error("HTTP Error ".concat(e.statusText));t.status=e.status,t.response=e,console.log(t)}return e}D.ETF_SYMBOLS=["URTH","IWM","QQQ","DIA","SPY"];var N=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).refreshHeadlines=function(){var e;e=function(e){"error"===e.status?alert(_.serverError("Refresh Headlines",e.message)):(e.articles.forEach((function(e,t){t>r.state.articles.length-1||e.title!==r.state.articles[t].title?e.fontWeight="bold":e.fontWeight="normal"})),r.setState({articles:e.articles}))},fetch("/api/headlines",{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then(e).catch((function(e){alert(_.serverError("Refresh Headlines",e))}))},r.refreshDJIA=function(){var e;e=function(e){if("error"in e)alert(_.serverError("Refresh DJIA",e.error));else{var t=e.price.replace(/\,/g,""),n=e.change.split(" ")[0].replace(/\,/g,"");r.setState({djiaValue:new A(t,"index"),djiaChange:new A(n,"index","delta"),refreshTime:new Date})}},fetch("/api/last-djia",{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then(e).catch((function(e){alert(_.serverError("Refresh Indexes",e))}))},r.refreshIndexes=function(){var e;e=function(e){if("error"in e)alert(_.serverError("Refresh Indexes",e.error));else{var t=e.data.find((function(e){return"DJIA"===e.attributes.instrument.symbol}));t&&r.setState({djiaValue:new A(t.attributes["trade-price"],"index"),djiaChange:new A(t.attributes["price-change"],"index","delta"),refreshTime:new Date})}},fetch("/api/last-index?symbols=DJIA",{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then(e).catch((function(e){alert(_.serverError("Refresh Indexes",e))}))},r.state={articles:[],djiaValue:new A(0,"index"),djiaChange:new A(0,"index","delta"),headlinesIntervalId:-1,indexesIntervalId:-1,refreshTime:new Date},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.refreshHeadlines(),this.setState({headlinesIntervalId:window.setInterval(this.refreshHeadlines,n.HEADLINES_REFRESH_INTERVAL)}),this.refreshDJIA(),this.setState({indexesIntervalId:window.setInterval(this.refreshDJIA,n.INDEXES_REFRESH_INTERVAL)})}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.state.headlinesIntervalId),window.clearInterval(this.state.indexesIntervalId)}},{key:"render",value:function(){var e=this.props.userLocale;return Object(a.jsx)(T,{articles:this.state.articles,djiaValue:this.state.djiaValue,djiaChange:this.state.djiaChange,refreshTime:this.state.refreshTime,refreshHeadlines:this.refreshHeadlines,userLocale:e})}}]),n}(s.Component);N.HEADLINES_REFRESH_INTERVAL=3e5,N.INDEXES_REFRESH_INTERVAL=6e4;var M=Object(f.b)((function(e){return{userLocale:e.users.user.locale}}))(N),q=n(146),U=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{children:"No Investment Advice or Recommendations"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:"The content of the Portfolio Analyzer app is for educational and entertainment purposes only."}),Object(a.jsx)("li",{children:"Any information contained herein should be verfied through other sources."}),Object(a.jsx)("li",{children:"No decisions should be based on this app."})]}),Object(a.jsx)("h3",{children:"No Security"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:"The application is currently configured such that all users share the same public account."}),Object(a.jsx)("li",{children:"Any data you enter is viewable and changeable by any other user at any time."})]}),Object(a.jsx)("h3",{children:"Market Data"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:["Latest trade data provided for free by ",Object(a.jsx)("a",{href:"https://iexcloud.io",target:"_blank",rel:"noopener noreferrer",children:"IEX"}),". ",Object(a.jsx)("a",{href:"https://iextrading.com/api-terms/",target:"_blank",rel:"noopener noreferrer",children:"(IEX Terms Of Service)"})]}),Object(a.jsxs)("li",{children:["The Dow Jones Industrial Average is provided by ",Object(a.jsx)("a",{href:"https://finance.yahoo.com/",target:"_blank",rel:"noopener noreferrer",children:"Yahoo Finance"}),"."]}),Object(a.jsx)("li",{children:"Note that the prices shown may not be the correct prices nor the latest prices."}),Object(a.jsx)("li",{children:"Any prices displayed should be verfied through other sources."}),Object(a.jsx)("li",{children:"When the application is first opened, the prices displayed are from the last time someone refreshed a portfolio containing those same symbols. Pressing refresh will update those prices with the latest available prices."}),Object(a.jsx)("li",{children:"Day change values are calculated based on the previous close price, not the current open price."})]}),Object(a.jsx)("h3",{children:"Portfolio Charts"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:["Monthly adjusted historical series data is provided by ",Object(a.jsx)("a",{href:"https://www.alphavantage.co",target:"_blank",rel:"noopener noreferrer",children:"Alpha Vantage"}),"."]}),Object(a.jsx)("li",{children:"The chart start date will be the earliest date where all portfolio instruments have data (to a maximum of 5 years ago)."}),Object(a.jsx)("li",{children:"For a more accurate performance comparison, the comparison instruments displayed on the chart are index ETFs, and not the indices themselves (e.g. DIA, not DJIA)."})]}),Object(a.jsx)("h3",{children:"Headline News"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:["Headline News is provided by ",Object(a.jsx)("a",{href:"https://newsapi.org",target:"_blank",rel:"noopener noreferrer",children:"NewsAPI.org"}),"."]}),Object(a.jsx)("li",{children:"Headlines are set to refresh every 5 minutes."}),Object(a.jsx)("li",{children:"The DJIA index is set to refresh every 1 minute."})]}),Object(a.jsx)("h3",{children:"Symbol Lookup"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:["Uses ",Object(a.jsx)("a",{href:"https://iextrading.com/trading/eligible-symbols/",target:"_blank",rel:"noopener noreferrer",children:"IEX symbology"}),"."]}),Object(a.jsx)("li",{children:"Accepts the wildcard character '%'."})]}),Object(a.jsx)("h3",{children:"Known issues:"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:"Chart data is not available for every instrument."}),Object(a.jsx)("li",{children:"To avoid exceeding vendor call rate limits, series data will only be updated when saved series data does not already contain the last saved trade's date and price. In other words, to update a series, the latest stored trade must be different than what has already been saved in the series. Therefore, a price refresh should be done before updating series data."}),Object(a.jsx)("li",{children:"Series data provided by the feed vendor may or may not include the latest trading day."}),Object(a.jsx)("li",{children:"Due to license restrictions, Headline News may post an error popup if the daily request limit is reached."}),Object(a.jsx)("li",{children:"Some server errors will display popups for debugging purposes. This is expected since this is a development environment."})]})]})},V=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(q.a,{trigger:this.props.trigger,closeIcon:"close",children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:"Notes",icon:"info circle",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(U,{})}),Object(a.jsx)(q.a.Actions,{})]})}}]),n}(s.Component),B=n(17);function z(e,t,n,r){var o=e,i=n,a="ascending"!==t,s="ascending"!==r;return function(e,t,n,r){if("undefined"===typeof e)return{primary:{property:o,direction:a?"descending":"ascending"},secondary:{property:i,direction:s?"descending":"ascending"}};n&&(a=o===n&&!a,o=n),r&&(s=i===r&&!s,i=r),t(e,o,a,i,s)}}var W=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=function(t){return n?n(t[e]):t[e]};return function(e,n){var o=r(e),i=r(n),a=[1,-1][+!!t];return"number"===typeof o.valueOf()&&"number"===typeof i.valueOf()?J(o,i,a):G(o,i,a)}};function J(e,t,n){if(!isFinite(e)||!isFinite(t)){if(!isFinite(e)&&!isFinite(t))return 0;if(!isFinite(e)&&isFinite(t))return-1*n;if(isFinite(e)&&!isFinite(t))return 1*n}return(e<t?-1:e>t?1:0)*n}function G(e,t,n){if(!e||!t){if(!e&&!t)return 0;if(!e&&t)return-1*n;if(e&&!t)return 1*n}return(e<t?-1:e>t?1:0)*n}var Y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(u.a)(this,e),this._id=t,this._name=n,this._positions=[],this.updateDerivedValues()}return Object(d.a)(e,[{key:"nameToHTML",value:function(){var e=_.valueColor(this._gainLoss);return Object(a.jsx)("span",{style:{color:e},children:this._name})}},{key:"reprice",value:function(e){this._positions.forEach((function(t){t.reprice(e)}))}},{key:"updateDerivedValues",value:function(){var e=0,t=0,n=0,r=0;this._positions.forEach((function(o){e+=o.cost,t+=o.dayChange,n+=o.gainLoss,r+=o.marketValue})),this._cost=new A(e,"currency"),this._dayChange=new A(t,"currency","delta"),this._gainLoss=new A(n,"currency","delta"),this._marketValue=new A(r,"currency")}},{key:"id",get:function(){return this._id}},{key:"cost",get:function(){return this._cost}},{key:"dayChange",get:function(){return this._dayChange}},{key:"gainLoss",get:function(){return this._gainLoss}},{key:"marketValue",get:function(){return this._marketValue}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"positions",get:function(){return this._positions}}],[{key:"accountSummary",value:function(e){var t=0,n=0,r=0,o=0;return e.forEach((function(e){t+=e.cost,n+=e.dayChange,r+=e.gainLoss,o+=e.marketValue})),t=new A(t,"currency"),n=new A(n,"currency","delta"),r=new A(r,"currency","delta"),o=new A(o,"currency"),{sumCost:t,sumDayChange:n,sumGainLoss:r,sumMarketValue:o}}},{key:"applyPrices",value:function(e,t){e.forEach((function(e){e.reprice(t),e.updateDerivedValues()}))}},{key:"sort",value:function(e,t,n,r,o){switch(t){case"name":e.sort(W("".concat(t),n,(function(e){return e.toUpperCase()})));break;default:e.sort(W("".concat(t),n))}e.forEach((function(e){switch(r){case"symbol":e._positions.sort(W("instrument",o,(function(e){return e.symbol})));break;default:e.positions.sort(W("".concat(r),o,(function(e){return e.valueOf()})))}}))}}]),e}(),X=n(68),Q="PORTFOLIO_ADD",$="PORTFOLIO_DELETE",K="PORTFOLIOS_ERROR",Z="PORTFOLIO_UPDATE",ee="PORTFOLIOS_UPDATE",te="PORTFOLIO_UPDATING",ne="PORTFOLIOS_WARN";function re(e){return{type:K,payload:e}}function oe(e){return{type:ee,payload:e}}function ie(){return{type:te}}var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(u.a)(this,e),this._id=t,this._symbol=n,this._name=r}return Object(d.a)(e,[{key:"symbolToHTML",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=_.valueColor(e);return Object(a.jsx)("span",{style:{color:t},children:this._symbol})}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"symbol",get:function(){return this._symbol}}]),e}(),se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(u.a)(this,e);var n=Date.parse(t);this._value=isNaN(n)?new Date:new Date(n)}return Object(d.a)(e,[{key:"valueOf",value:function(){return this._value}},{key:"toForm",value:function(){return this._value.toISOString().substring(0,10)}},{key:"toHTML",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.toString(e),r=t||"black";return Object(a.jsx)("span",{style:{color:r},children:n})}},{key:"toString",value:function(e){return e?this.toStringFormatted(e):this._value.toString()}},{key:"toStringFormatted",value:function(t){var n=new Intl.DateTimeFormat(t,e.DATE_OPTIONS);return this._value?n.format(this._value).replace(",",""):""}}]),e}();se.DATE_OPTIONS={year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};var ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";Object(u.a)(this,e),this._instrumentId=t,this._lastUpdate=new se(i),this._price=new A(n,"currency"),this._priceChange=new A(r,"currency","delta"),this._tradeDate=new se(o)}return Object(d.a)(e,[{key:"lastUpdate",get:function(){return this._lastUpdate}},{key:"price",get:function(){return this._price}},{key:"priceChange",get:function(){return this._priceChange}},{key:"tradeDate",get:function(){return this._tradeDate}}]),e}(),le=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";Object(u.a)(this,e),this._portfolio_id=t,this._id=n,this._cost=new A(o,"currency"),this._dateAcquired=new se(i),this._instrument=new ae,this._quantity=new A(r,"quantity"),this._trade=new ce,this.updateDerivedValues()}return Object(d.a)(e,[{key:"reprice",value:function(e){var t=this,n=e.find((function(e){return e.attributes["instrument-id"].toString()===t._instrument.id}));n&&(this._trade=new ce(this._instrument.id,n.attributes["trade-price"],n.attributes["price-change"],n.attributes["trade-date"],n.attributes["created-at"]),this.updateDerivedValues())}},{key:"updateDerivedValues",value:function(){this._dayChange=new A(this.quantity*this.priceChange,"currency","delta"),this._marketValue=new A(this.quantity*this.lastTrade,"currency"),this._gainLoss=new A(this.marketValue-this.cost,"currency","delta"),this._pctTotalMV=new A(0,"percent")}},{key:"cost",get:function(){return this._cost},set:function(e){this._cost=new A(e,"currency")}},{key:"dateAcquired",get:function(){return this._dateAcquired},set:function(e){this._dateAcquired=new se(e)}},{key:"dayChange",get:function(){return this._dayChange}},{key:"gainLoss",get:function(){return this._gainLoss}},{key:"id",get:function(){return this._id}},{key:"instrument",get:function(){return this._instrument},set:function(e){this._instrument=e}},{key:"lastTrade",get:function(){return this._trade.price}},{key:"lastUpdate",get:function(){return this._trade.lastUpdate}},{key:"lastTradeDate",get:function(){return this._trade.tradeDate}},{key:"marketValue",get:function(){return this._marketValue}},{key:"pctTotalMV",get:function(){return this._pctTotalMV},set:function(e){this._pctTotalMV=new A(e,"percent")}},{key:"portfolio_id",get:function(){return this._portfolio_id}},{key:"priceChange",get:function(){return this._trade.priceChange}},{key:"quantity",get:function(){return this._quantity},set:function(e){this._quantity=new A(e,"quantity")}}],[{key:"validateStringInput",value:function(e,t){var n=null;/^[A-Z.*+-]+$/.test(e.symbol)?Number.isNaN(parseFloat(e.quantity))||!isFinite(e.quantity)?n={name:"quantity",message:"Quantity must be a number."}:Number.parseFloat(e.quantity)>=0?Number.isNaN(parseFloat(e.cost))||!isFinite(e.cost)?n={name:"cost",message:"Cost must be a number."}:e.cost<0?n={name:"cost",message:"Cost must be greater than or equal to zero."}:Number.isNaN(Date.parse(e.dateAcquired))&&(n={name:"dateAcquired",message:"Date Acquired is not valid."}):n={name:"quantity",message:"Quantity must be greater than or equal to zero."}:n={name:"symbol",message:"Symbol is not valid."},null===n?E({value:e.symbol,exact:!0},(function(e){1!==e.data.length&&(n={name:"symbol",message:"Symbol is not valid."}),t(n)})):t(n)}}]),e}(),ue="USER_ERROR",de="USER_UPDATE",he="USER_UPDATING",pe="USER_WARN";function fe(e){return{type:de,payload:e}}function je(){return{type:he}}function be(e,t){fetch("/api/portfolios/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:t.name})}).then(F).then((function(e){return e.json()})).then((function(t){if(!t.data.id)throw new Error("Portfolio add failed!");var n=new Y(t.data.id,t.data.attributes.name);e(function(e){return{type:Q,payload:e}}(n))})).catch((function(t){return e(re({prefix:"Add Portfolio: ",error:t.message}))}))}function me(e,t){fetch("/api/portfolios/".concat(t),{method:"DELETE",headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then((function(n){if(!n.data.id)throw new Error("Portfolio delete failed!");e(function(e){return{type:$,payload:e}}(t))})).catch((function(t){return e(re({prefix:"Delete Portfolio: ",error:t.message}))}))}function ge(e,t){fetch("/api/portfolios/".concat(t.id),{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:t.name})}).then(F).then((function(e){return e.json()})).then((function(n){if(!n.data.id)throw new Error("Portfolio update failed!");t.name=n.data.attributes.name,e(function(e){return{type:Z,payload:e}}(t))})).catch((function(t){return e(re({prefix:"Update Portfolio: ",error:t.message}))}))}function Oe(e,t,n){fetch("/api/portfolios/",{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then((function(r){var o=r.data.map((function(e){return new Y(e.id,e.attributes.name)})),i=[],a=[];r.included.forEach((function(e){switch(e.type){case"instruments":i.push(new ae(e.id,e.attributes.symbol,e.attributes.name));break;case"positions":a.push(new le(e.attributes["portfolio-id"],e.id,e.attributes.quantity,e.attributes.cost,e.attributes["date-acquired"]));break;default:console.log("Error: unknown relation type: "+e.type)}})),r.included.forEach((function(e){switch(e.type){case"positions":var t=e.id,n=a.find((function(e){return e.id===t})),r=e.relationships.instrument.data.id,o=i.find((function(e){return e.id===r}));n.instrument=o}})),r.data.forEach((function(e){var t=e.id,n=o.find((function(e){return e.id===t}));e.relationships.positions.data.forEach((function(e){switch(e.type){case"positions":var t=e.id,r=a.find((function(e){return e.id===t}));n.positions.push(r)}})),n.updateDerivedValues()})),fetch("/api/portfolios/last-price?".concat(!0===t?"livePrices":""),{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then((function(t){"error"in t?e(re({prefix:"Load Portfolios: ",error:t})):(t.data.forEach((function(t){var n;null!==t.attributes.error&&e((n={prefix:"Load Portfolios Prices for ",warning:t.attributes.error},{type:ne,payload:n}))})),Y.applyPrices(o,t.data),n(o,Y.sort),e(oe(o)))})).catch((function(t){return e(re({prefix:"Load Portfolios: ",error:t.message}))}))})).catch((function(t){return e(re({prefix:"Load Portfolios: ",error:t.message}))}))}function ye(e,t){return fetch("/api/users/".concat(t),{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then((function(t){e(fe(t))})).catch((function(t){return e(function(e){return{type:ue,payload:e}}({prefix:"User Fetch: ",error:t.message}))}))}function ve(e){return function(t){t(ie()),be(t,e)}}function xe(e){return function(t){t(ie()),me(t,e)}}function Ce(e,t){return function(n){n(ie()),Oe(n,e,t)}}function ke(e,t,n){return function(r){return r(ie()),n(e,Y.sort,t),r(oe(e))}}function we(e){return function(t){t(ie()),ge(t,e)}}var Se=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"seriesDataToChartData",value:function(t,n,r){var o={};if(0===t.data.length)return o;t.included.forEach((function(e){o[e.id]={symbol:e.attributes.symbol,name:e.attributes.name,shares:0,data:[]}}));var i=e.latestSeriesStartDate(t);return t.data.forEach((function(t){var n=t.attributes,r=t.relationships.instrument.data.id;if(n["series-date"]>=i){var a=e.convertToPlotPoint(n,o[r]);null!==a&&o[r].data.push(a)}})),e.addPortfolioSummary(o,n,r)}},{key:"addPortfolioSummary",value:function(e,t,n){var r=Number.MAX_SAFE_INTEGER;Object.values(e).forEach((function(e){e.data.length<r&&(r=e.data.length)})),e[0]={symbol:"Portfolio",name:t,data:[]};var o=n.length;return n.forEach((function(t){var n=e[t];n?n.data.forEach((function(t,n){n<r&&(n===e[0].data.length?e[0].data.push([t[0],t[1]]):e[0].data[n][1]+=t[1])})):o-=1})),e[0].data.forEach((function(e){e[1]/=o})),e}},{key:"convertToPlotPoint",value:function(e,t){var n=parseFloat(e["adjusted-close-price"]),r=t.shares;if(0===r&&n>0){r=10/n,t.shares=r}return[Date.parse(e["series-date"]),r*n]}},{key:"latestSeriesStartDate",value:function(e){var t="",n=null;return e.data.forEach((function(e){var r=e.relationships.instrument.data.id;if(r!==n){n=r;var o=e.attributes["series-date"];o>t&&(t=o)}})),t}}]),e}(),Ae=n(178),_e=n.n(Ae),Te=n(181),De=n(171),Ee=n(167),Le=n(172),He=n(168),Pe=n(173),Re=n(174),Ie=n(175),Fe=n(109),Ne={},Me=Object(Fe.a)((function(e){var t=e.portfolioName,n=e.refData;return Object(a.jsx)("div",{className:"app",children:Object(a.jsxs)(De.a,{plotOptions:Ne,children:[Object(a.jsx)(Ee.a,{type:"spline"}),Object(a.jsx)(Le.a,{children:"$10,000 Investment Comparison"}),Object(a.jsx)(He.a,{}),Object(a.jsx)(Pe.a,{shared:!0,useHTML:!0,valueDecimals:"3",headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>&dollar;{point.y}K</b></td></tr>',footerFormat:"</table>"}),Object(a.jsx)(Re.a,{type:"datetime",crosshair:!0}),Object(a.jsx)(Ie.a,{id:"yAxis",labels:{format:"${value}K"},children:Object.values(n).map((function(e){return Object(a.jsx)(Te.a,{id:e.name,marker:{enabled:!1},visible:e.name===t&&e.data.length>0||"SPY"===e.symbol,name:"".concat(_.truncate(e.name,20)," (").concat(e.symbol,")"),data:e.data},e.symbol)}))})]})})}),_e.a),qe=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).refreshData=function(){var e=r.props.portfolio,t=e.positions.map((function(e){return e.instrument.id})),o=e.positions.map((function(e){return e.instrument.symbol})),i=Object(X.a)(new Set(o.concat(D.ETF_SYMBOLS))).join(","),a=new Date(Date.now());!function(e,t,n,r){fetch("/api/monthly-series?symbols=".concat(e,"&start_date=").concat(t,"&end_date=").concat(n),{headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then(r).catch((function(e){alert(_.serverError("Refresh Series",e))}))}(i,new Date(a.getFullYear()-n.CHART_RANGE,a.getMonth(),a.getDate()).toJSON(),a.toJSON(),(function(n){if("error"in n)alert(_.serverError("Refresh Series",n.error));else{var o=Se.seriesDataToChartData(n,e.name,t);r.setState({refData:o})}}))},r.resetComponent=function(){r.setState({modalOpen:!1})},r.handleCancel=function(){r.resetComponent()},r.handleOpen=function(){r.refreshData(),r.setState({modalOpen:!0})},r.state={modalOpen:!1,refData:[]},r}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.resetComponent()}},{key:"render",value:function(){var e=this.props,t=e.iconColor,n=e.iconName,r=e.portfolio,o=e.tooltip,i=this.state,s=i.refData,c=i.modalOpen;return Object(a.jsxs)(q.a,{closeIcon:!0,closeOnDimmerClick:!1,trigger:Object(a.jsx)(k.a,{name:n,title:o,id:"portfolioChart",link:!0,color:t,onClick:this.handleOpen}),open:c,onClose:this.handleCancel,size:"large",style:{paddingBottom:"10px"},children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:r.nameToHTML(),icon:"chart line",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(Me,{refData:s,portfolioName:r.name})}),Object(a.jsx)(q.a.Actions,{children:Object(a.jsx)(y.a,{floated:"left",color:"red",onClick:this.handleCancel,children:"Close"})})]})}}]),n}(s.Component);qe.CHART_RANGE=5;var Ue=Object(f.b)(void 0,(function(e){return{actions:Object(B.b)(r,e)}}))(qe),Ve=n(106),Be=n.n(Ve),ze=n(239),We=function(e){var t=e.onChange,n=e.onSubmit,r=e.portfolio;return Object(a.jsx)(ze.a,{id:"portfolioEditForm",onSubmit:n,children:Object(a.jsx)(ze.a.Group,{children:Object(a.jsx)(ze.a.Input,{width:4,label:"Name",placeholder:"Name",name:"name",value:r.name,onChange:t,autoFocus:!0,required:!0})})})},Je=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).resetComponent=function(){e.setState({editedPortfolio:{},modalOpen:!1})},e.handleCancel=function(){e.resetComponent()},e.handleChange=function(t,n){var r=n.name,o=n.value,i=e.state.editedPortfolio,a=Be()(i);a[r]=o,e.setState({editedPortfolio:a})},e.handleOpen=function(){var t=e.props.portfolio;e.setState({editedPortfolio:Be()(t),modalOpen:!0})},e.handleSubmit=function(){var t=e.props.actions,n=e.state.editedPortfolio;n.id?t.portfolioUpdate(n):t.portfolioAdd(n),e.resetComponent()},e}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.resetComponent()}},{key:"render",value:function(){var e=this.props,t=e.iconColor,n=e.iconName,r=e.tooltip,o=this.state,i=o.editedPortfolio,s=o.modalOpen;return Object(a.jsxs)(q.a,{closeOnDimmerClick:!1,trigger:Object(a.jsx)(k.a,{name:n,title:r,id:"portfolioEdit",link:!0,color:t,onClick:this.handleOpen}),open:s,onClose:this.handleCancel,style:{paddingBottom:"10px"},children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:"Portfolio Editor",icon:"edit",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(We,{portfolio:i,onChange:this.handleChange,onSubmit:this.handleSubmit})}),Object(a.jsxs)(q.a.Actions,{children:[Object(a.jsx)(y.a,{floated:"left",color:"red",onClick:this.handleCancel,children:"Cancel"}),Object(a.jsx)(y.a,{type:"submit",floated:"left",color:"green",form:"portfolioEditForm",children:"Submit"})]})]})}}]),n}(s.Component);var Ge=Object(f.b)(void 0,(function(e){return{actions:Object(B.b)(r,e)}}))(Je),Ye=function(e){var t=e.onClickColHeader,n=e.onClickRemove,r=e.portfolios,o=e.refreshPortfolios,i=e.sortColName,s=e.sortDirection,c=e.totalCost,l=e.totalDayChange,u=e.totalGainLoss,d=e.totalMarketValue,h=e.updatingPortfolio,p=e.userLocale;return Object(a.jsxs)("div",{children:[Object(a.jsxs)(C.a,{size:"medium",color:"purple",style:{marginBottom:0,marginLeft:"4px"},children:["Account Summary",Object(a.jsx)("span",{style:{float:"right"},children:Object(a.jsx)(y.a,{content:"Refresh",icon:"refresh",title:"Refresh portfolios",loading:h,compact:!0,inverted:!0,size:"tiny",style:{paddingRight:"3px",color:"purple"},onClick:function(){return o()}})})]}),Object(a.jsxs)(O.a,{compact:!0,sortable:!0,striped:!0,style:{marginTop:0},children:[Object(a.jsx)(O.a.Header,{children:Object(a.jsxs)(O.a.Row,{textAlign:"center",children:[Object(a.jsx)(O.a.HeaderCell,{children:Object(a.jsx)(Ge,{portfolio:new Y,iconName:"add",iconColor:"blue",tooltip:"Add a portfolio"})}),Object(a.jsx)(O.a.HeaderCell,{sorted:"name"===i?s:null,onClick:function(){return t("name")},textAlign:"left",children:"Portfolios"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"marketValue"===i?s:null,onClick:function(){return t("marketValue")},children:"Market Value"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"dayChange"===i?s:null,onClick:function(){return t("dayChange")},children:"Day Change"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"cost"===i?s:null,onClick:function(){return t("cost")},children:"Cost Basis"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"gainLoss"===i?s:null,onClick:function(){return t("gainLoss")},children:"Gain/Loss"})]})}),Object(a.jsx)(O.a.Body,{children:r.map((function(e){return Object(a.jsxs)(O.a.Row,{textAlign:"right",children:[Object(a.jsxs)(O.a.Cell,{textAlign:"center",children:[Object(a.jsx)(Ge,{portfolio:e,iconName:"edit",iconColor:"blue",tooltip:"Edit portfolio name"}),"\u2003",Object(a.jsx)(S,{triggerType:"icon",name:"trash",color:"red",title:"Delete portfolio",header:"Delete Portfolio ".concat(e.name),onClickConfirm:n(e.id)}),"\u2003",Object(a.jsx)(Ue,{portfolio:e,iconName:"chart line",iconColor:"blue",tooltip:"Chart portfolio"})]}),Object(a.jsx)(O.a.Cell,{textAlign:"left",children:Object(a.jsx)(j.b,{to:"/portfolios/".concat(e.id),title:"View details",children:e.nameToHTML()})}),Object(a.jsx)(O.a.Cell,{children:e.marketValue.toHTML(p)}),Object(a.jsx)(O.a.Cell,{children:e.dayChange.toHTML(p)}),Object(a.jsx)(O.a.Cell,{children:e.cost.toHTML(p)}),Object(a.jsx)(O.a.Cell,{children:e.gainLoss.toHTML(p)})]},e.id)}))}),Object(a.jsx)(O.a.Footer,{children:Object(a.jsxs)(O.a.Row,{textAlign:"right",children:[Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{textAlign:"left",children:"Total"}),Object(a.jsx)(O.a.HeaderCell,{children:d.toHTML(p)}),Object(a.jsx)(O.a.HeaderCell,{children:l.toHTML(p)}),Object(a.jsx)(O.a.HeaderCell,{children:c.toHTML(p)}),Object(a.jsx)(O.a.HeaderCell,{children:u.toHTML(p)})]})})]})]})},Xe=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).refreshPortfolios=function(){e.props.actions.portfoliosLoad(!0,e.props.sortFn)},e.removePortfolio=function(t){var n=e.props.actions.portfolioDelete;return function(){n(t)}},e.sortPortfolios=function(t){e.props.actions.portfoliosSort(e.props.portfolios,t,e.props.sortFn)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.portfolios.length||this.props.actions.portfoliosLoad(!1,this.props.sortFn)}},{key:"render",value:function(){var e=this.props,t=e.portfolios,n=e.sortFn,r=e.updatingPortfolio,o=e.userLocale,i=Y.accountSummary(t),s=i.sumCost,c=i.sumDayChange,l=i.sumGainLoss,u=i.sumMarketValue,d=n();return Object(a.jsx)(Ye,{portfolios:t,updatingPortfolio:r,totalCost:s,totalDayChange:c,totalGainLoss:l,totalMarketValue:u,refreshPortfolios:this.refreshPortfolios,onClickRemove:this.removePortfolio,onClickColHeader:this.sortPortfolios,sortColName:d.primary.property,sortDirection:d.primary.direction,userLocale:o})}}]),n}(s.Component);var Qe=Object(f.b)((function(e){return{portfolios:e.portfolios.portfolios,sortFn:e.portfolios.sortFn,updatingPortfolio:e.portfolios.updatingPortfolio,userLocale:e.users.user.locale}}),(function(e){return{actions:Object(B.b)(r,e)}}))(Xe),$e=n(73);function Ke(e,t){return function(n){n(ie()),function(e,t,n){fetch("/api/portfolios/".concat(t.portfolio_id,"/positions"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instrument_symbol:t.symbol,quantity:t.quantity.toString(),cost:t.cost.toString(),date_acquired:t.dateAcquired.toForm()})}).then(F).then((function(e){return e.json()})).then((function(t){if(!t.data.id)throw new Error("Position add failed! ".concat(t[0],"."));Oe(e,!1,n)})).catch((function(t){return e(re({prefix:"Add Position: ",error:t.message}))}))}(n,e,t)}}function Ze(e,t,n){return function(r){r(ie()),function(e,t,n,r){fetch("/api/portfolios/".concat(t,"/positions/").concat(n),{method:"DELETE",headers:{Accept:"application/json"}}).then(F).then((function(e){return e.json()})).then((function(t){if(!t.data.id)throw new Error("Position delete failed! ".concat(t[0],"."));Oe(e,!1,r)})).catch((function(t){return e(re({prefix:"Delete Position: ",error:t.message}))}))}(r,e,t,n)}}function et(e,t,n){return function(r){return r(ie()),n(e,Y.sort,null,t),r(oe(e))}}function tt(e,t){return function(n){n(ie()),function(e,t,n){fetch("/api/portfolios/".concat(t.portfolio_id,"/positions/").concat(t.id),{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instrument_symbol:t.symbol,quantity:t.quantity.toString(),cost:t.cost.toString(),date_acquired:t.dateAcquired.toForm()})}).then(F).then((function(e){return e.json()})).then((function(t){"error"in t&&e(re({prefix:"Update Position: ",error:t})),Oe(e,!1,n)})).catch((function(t){return e(re({prefix:"Update Position: ",error:t.message}))}))}(n,e,t)}}var nt=n(242),rt=function(e){var t=e.formError,n=e.onChange,r=e.onSubmit,o=e.position;return Object(a.jsxs)(ze.a,{id:"positionEditForm",onSubmit:r,error:0!==Object.keys(t).length,children:[Object(a.jsxs)(ze.a.Group,{children:[Object(a.jsx)(ze.a.Input,{width:4,error:"symbol"===t.name,label:"Symbol",placeholder:"Symbol",name:"symbol",value:o.symbol,onChange:n,autoFocus:!0,required:!0}),Object(a.jsx)(ze.a.Input,{width:4,error:"quantity"===t.name,label:"Quantity",placeholder:"Quantity",name:"quantity",value:o.quantity,onChange:n,required:!0}),Object(a.jsx)(ze.a.Input,{width:4,error:"cost"===t.name,label:"Cost Basis",placeholder:"Cost Basis",name:"cost",value:o.cost,onChange:n,required:!0}),Object(a.jsx)(ze.a.Input,{width:4,error:"dateAcquired"===t.name,label:"Date Acquired",type:"date",placeholder:"YYYY-MM-DD",name:"dateAcquired",value:o.dateAcquired,onChange:n,required:!0})]}),Object(a.jsx)(nt.a,{hidden:0!==Object.keys(t).length,content:"Update position info. Press Cancel or Submit when done."}),Object(a.jsx)(nt.a,{error:!0,content:t.message})]})},ot=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).resetComponent=function(){e.setState({editedPosition:{},stringPosition:{symbol:"",quantity:"",cost:"",dateAcquired:""},formError:{},modalOpen:!1})},e.handleCancel=function(){e.resetComponent()},e.handleChange=function(t,n){var r=n.name,o=n.value,i=e.state.stringPosition,a="symbol"===r?o.toUpperCase():o;i[r]=a,e.setState({stringPosition:i})},e.handleOpen=function(){var t=e.state.stringPosition,n=e.props.position;t.symbol=n.instrument.symbol,t.quantity=n.quantity,t.cost=n.cost,t.dateAcquired=n.dateAcquired.toForm(),e.setState({editedPosition:Be()(n),modalOpen:!0,stringPosition:t})},e.handleSubmit=function(){var t=e.props,n=t.actions,r=t.sortFn,o=e.state,i=o.editedPosition,a=o.stringPosition;le.validateStringInput(a,(function(t){t?e.setState({formError:t}):(i.symbol=a.symbol,i.quantity=a.quantity,i.cost=a.cost,i.dateAcquired=a.dateAcquired,i.id?n.positionUpdate(i,r):n.positionAdd(i,r),e.resetComponent())}))},e}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.resetComponent()}},{key:"render",value:function(){var e=this.props,t=e.iconColor,n=e.iconName,r=e.tooltip,o=this.state,i=o.formError,s=o.modalOpen,c=o.stringPosition;return Object(a.jsxs)(q.a,{closeOnDimmerClick:!1,trigger:Object(a.jsx)(k.a,{name:n,title:r,link:!0,color:t,onClick:this.handleOpen}),open:s,onClose:this.handleCancel,style:{paddingBottom:"10px"},children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:"Position Editor",icon:"edit",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(rt,{position:c,formError:i,onChange:this.handleChange,onSubmit:this.handleSubmit})}),Object(a.jsxs)(q.a.Actions,{children:[Object(a.jsx)(y.a,{floated:"left",color:"red",onClick:this.handleCancel,children:"Cancel"}),Object(a.jsx)(y.a,{type:"submit",floated:"left",color:"green",form:"positionEditForm",children:"Submit"})]})]})}}]),n}(s.Component);var it=Object(f.b)((function(e){return{sortFn:e.portfolios.sortFn}}),(function(e){return{actions:Object(B.b)(o,e)}}))(ot),at=function(e){var t,n,r=e.onClickColHeader,o=e.onClickRemove,i=e.portfolio,s=e.portfolioRefresh,c=e.sortColName,l=e.sortDirection,u=e.updatingPortfolio,d=e.userLocale;return Object(a.jsxs)("div",{children:[Object(a.jsxs)(C.a,{size:"medium",color:"purple",style:{marginBottom:0,marginLeft:"4px"},children:[i.nameToHTML(),Object(a.jsxs)("span",{children:["\u2003",Object(a.jsx)(Ue,{portfolio:i,iconName:"chart line",iconColor:"blue",tooltip:"Chart portfolio"})]}),Object(a.jsx)("span",{style:{float:"right"},children:Object(a.jsx)(y.a,{content:"Refresh",icon:"refresh",title:"Refresh positions",loading:u,compact:!0,inverted:!0,size:"tiny",style:{paddingRight:"3px",color:"purple"},onClick:function(){return s()}})})]}),Object(a.jsxs)(O.a,{compact:!0,sortable:!0,striped:!0,style:{marginTop:0},children:[Object(a.jsx)(O.a.Header,{children:Object(a.jsxs)(O.a.Row,{textAlign:"center",children:[Object(a.jsx)(O.a.HeaderCell,{children:Object(a.jsx)(it,{position:new le(i.id),iconName:"add",iconColor:"blue",tooltip:"Add a position"})}),Object(a.jsx)(O.a.HeaderCell,{sorted:"symbol"===c?l:null,textAlign:"left",onClick:function(){return r("symbol")},children:"Symbol"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"quantity"===c?l:null,onClick:function(){return r("quantity")},children:"Quantity"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"lastTrade"===c?l:null,onClick:function(){return r("lastTrade")},children:"Price"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"priceChange"===c?l:null,onClick:function(){return r("priceChange")},children:"Change"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"marketValue"===c?l:null,onClick:function(){return r("marketValue")},children:"Market Value"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"pctTotalMV"===c?l:null,onClick:function(){return r("pctTotalMV")},children:"% of Portfolio"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"dayChange"===c?l:null,onClick:function(){return r("dayChange")},children:"Day Change"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"cost"===c?l:null,onClick:function(){return r("cost")},children:"Cost Basis"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"gainLoss"===c?l:null,onClick:function(){return r("gainLoss")},children:"Gain/Loss"}),Object(a.jsx)(O.a.HeaderCell,{sorted:"lastTradeDate"===c?l:null,onClick:function(){return r("lastTradeDate")},children:"Last Trade"})]})}),Object(a.jsx)(O.a.Body,{children:(t=i.positions,n=i.marketValue,t.map((function(e){return e.pctTotalMV=e.marketValue/n,Object(a.jsxs)(O.a.Row,{textAlign:"right",children:[Object(a.jsxs)(O.a.Cell,{textAlign:"center",children:[Object(a.jsx)(it,{position:e,iconName:"edit",iconColor:"blue",tooltip:"Edit position"}),Object(a.jsx)(S,{triggerType:"icon",name:"trash",color:"red",title:"Delete position",header:"Delete Position ".concat(e.instrument.symbol),onClickConfirm:o(i.id,e.id)})]}),Object(a.jsx)(O.a.Cell,{textAlign:"left",title:e.instrument.name,children:e.instrument.symbolToHTML(e.gainLoss)}),Object(a.jsx)(O.a.Cell,{children:e.quantity.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.lastTrade.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.priceChange.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.marketValue.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.pctTotalMV.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.dayChange.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.cost.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.gainLoss.toHTML(d)}),Object(a.jsx)(O.a.Cell,{children:e.lastTradeDate.toHTML(d)})]},e.id)})))}),Object(a.jsx)(O.a.Footer,{children:Object(a.jsxs)(O.a.Row,{textAlign:"right",children:[Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{textAlign:"left",children:"Total"}),Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{children:i.marketValue.toHTML(d)}),Object(a.jsx)(O.a.HeaderCell,{}),Object(a.jsx)(O.a.HeaderCell,{children:i.dayChange.toHTML(d)}),Object(a.jsx)(O.a.HeaderCell,{children:i.cost.toHTML(d)}),Object(a.jsx)(O.a.HeaderCell,{children:i.gainLoss.toHTML(d)}),Object(a.jsx)(O.a.HeaderCell,{})]})})]})]})},st=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).portfolioRefresh=function(){r.props.actions.portfoliosLoad(!0,r.props.sortFn)},r.positionRemove=function(e,t){var n=r.props.actions.positionDelete,o=r.props.sortFn;return function(){n(e,t,o)}},r.positionsSort=function(e){r.props.actions.positionsSort(r.props.portfolios,e,r.props.sortFn)},r.state={portfolioId:r.props.match.params.id},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.portfolios.length||this.props.actions.portfoliosLoad(!1,this.props.sortFn)}},{key:"render",value:function(){var e=this,t=this.props,n=t.portfolios,r=t.sortFn,o=t.updatingPortfolio,i=t.userLocale,s=n.find((function(t){return t.id===e.state.portfolioId}));if(s){var c=r();return Object(a.jsx)(at,{portfolio:s,updatingPortfolio:o,portfolioRefresh:this.portfolioRefresh,onClickSubmit:this.positionSubmit,onClickRemove:this.positionRemove,onClickColHeader:this.positionsSort,sortColName:c.secondary.property,sortDirection:c.secondary.direction,userLocale:i})}return null}}]),n}(s.Component);var ct=Object(f.b)((function(e){return{portfolios:e.portfolios.portfolios,sortFn:e.portfolios.sortFn,updatingPortfolio:e.portfolios.updatingPortfolio,userLocale:e.users.user.locale}}),(function(e){return{actions:Object(B.b)(Object($e.a)(Object($e.a)({},r),o),e)}}))(st),lt=n(90),ut=function(e){var t=e.onChange,n=e.onSubmit,r=e.user;return Object(a.jsx)(ze.a,{id:"settingsEditForm",onSubmit:n,children:Object(a.jsx)(ze.a.Group,{children:Object(a.jsx)(ze.a.Select,{label:"Locale",placeholder:"Locale",name:"locale",options:[{key:"de-DE",value:"de-DE",text:"German - Germany"},{key:"en-US",value:"en-US",text:"English-USA"},{key:"en-GB",value:"en-GB",text:"English-Great Britain"}],value:r.locale,onChange:t,required:!0})})})};function dt(){return function(e){e(je()),ye(e,1)}}function ht(e){return function(t){t(je()),function(e,t){fetch("/api/users/".concat(t.id),{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({locale:t.locale})}).then(F).then((function(e){return e.json()})).then((function(t){if(!t.data.id)throw new Error("User update failed!");e(fe(t))})).catch((function(e){alert(e.message)}))}(t,e)}}var pt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).resetComponent=function(){e.setState({editedUser:{},modalOpen:!1})},e.handleCancel=function(){e.resetComponent()},e.handleChange=function(t,n){var r=n.name,o=n.value;e.setState({editedUser:Object($e.a)(Object($e.a)({},e.state.editedUser),{},Object(lt.a)({},r,o))})},e.handleOpen=function(){var t=e.props.user;t&&e.setState({editedUser:Object($e.a)({},t)}),e.setState({modalOpen:!0})},e.handleSubmit=function(){e.props.actions.userUpdate(e.state.editedUser),e.resetComponent()},e}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.resetComponent(),this.props.actions.userLoad()}},{key:"render",value:function(){var e=this.state,t=e.editedUser,n=e.modalOpen;return Object(a.jsxs)(q.a,{closeOnDimmerClick:!1,trigger:Object(a.jsx)(x.a.Item,{onClick:this.handleOpen,children:"Settings"}),open:n,onClose:this.handleCancel,style:{paddingBottom:"10px"},children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:"Settings Editor",icon:"setting",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(ut,{user:t,onChange:this.handleChange,onSubmit:this.handleSubmit})}),Object(a.jsxs)(q.a.Actions,{children:[Object(a.jsx)(y.a,{floated:"left",color:"red",onClick:this.handleCancel,children:"Cancel"}),Object(a.jsx)(y.a,{type:"submit",floated:"left",color:"green",form:"settingsEditForm",children:"Submit"})]})]})}}]),n}(s.Component);var ft=Object(f.b)((function(e){return{user:e.users.user,updatingUser:e.users.updatingUser}}),(function(e){return{actions:Object(B.b)(i,e)}}))(pt),jt=function(e){var t=e.serverInstruments,n=e.onChange,r=e.searchValue;return Object(a.jsxs)(g.a,{children:[Object(a.jsx)(g.a.Row,{children:Object(a.jsx)(g.a.Column,{children:Object(a.jsx)(ze.a,{children:Object(a.jsx)(ze.a.Input,{width:8,className:"icon",icon:"search",placeholder:"Description",name:"searchValue",value:r,onChange:n,autoFocus:!0})})})}),Object(a.jsx)(g.a.Row,{children:Object(a.jsx)(g.a.Column,{children:Object(a.jsxs)(O.a,{compact:"very",striped:!0,children:[Object(a.jsx)(O.a.Header,{children:Object(a.jsxs)(O.a.Row,{children:[Object(a.jsx)(O.a.HeaderCell,{children:"Name"}),Object(a.jsx)(O.a.HeaderCell,{children:"Symbol"})]})}),Object(a.jsx)(O.a.Body,{children:t.map((function(e){return Object(a.jsxs)(O.a.Row,{children:[Object(a.jsx)(O.a.Cell,{width:8,children:e.attributes.name}),Object(a.jsx)(O.a.Cell,{width:3,children:e.attributes.symbol})]},e.id)}))})]})})})]})},bt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).resetComponent=function(){e.setState({modalOpen:!1,searchResults:[],searchValue:""})},e.handleCancel=function(){e.resetComponent()},e.handleChange=function(t,r){var o=r.name,i=r.value;e.setState(Object(lt.a)({},o,i)),"searchValue"===t.target.name&&(0===i.length?e.setState({searchResults:[]}):E({value:i,exact:!1},(function(t){e.setState({searchResults:t.data.slice(0,n.DISPLAY_ROWS_MAX)})})))},e.handleOpen=function(){e.setState({modalOpen:!0})},e}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.resetComponent()}},{key:"render",value:function(){var e=this.state,t=e.modalOpen,n=e.searchResults,r=e.searchValue;return Object(a.jsxs)(q.a,{closeIcon:!0,closeOnDimmerClick:!1,size:"small",trigger:Object(a.jsx)(x.a.Item,{onClick:this.handleOpen,children:"Symbol Lookup"}),open:t,onClose:this.handleCancel,children:[Object(a.jsx)(q.a.Header,{children:Object(a.jsx)(C.a,{content:"Symbol Lookup",icon:"search",size:"small"})}),Object(a.jsx)(q.a.Content,{children:Object(a.jsx)(jt,{searchValue:r,serverInstruments:n,onChange:this.handleChange})}),Object(a.jsx)(q.a.Actions,{children:Object(a.jsx)(y.a,{color:"green",onClick:this.handleCancel,children:"Done"})})]})}}]),n}(s.Component);bt.DISPLAY_ROWS_MAX=20;var mt=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"menuItemAdmin",value:function(){return Object(a.jsx)(m.a,{item:!0,text:"Admin",children:Object(a.jsxs)(m.a.Menu,{children:[Object(a.jsx)(S,{disabled:!0,triggerType:"dropdown",title:"Refresh Instruments...",header:"Background refresh instrument inventory from data feed",onClickConfirm:L}),Object(a.jsx)(S,{disabled:!0,triggerType:"dropdown",title:"Refresh Active Series...",header:"Background refresh active series prices",onClickConfirm:R}),Object(a.jsx)(S,{disabled:!0,triggerType:"dropdown",title:"Refresh All Prices...",header:"Background reprice entire instrument inventory (runs 12 hours)",onClickConfirm:H}),Object(a.jsx)(S,{disabled:!0,triggerType:"dropdown",title:"Refresh All Series...",header:"Background refresh all series prices (runs 2 days)",onClickConfirm:I})]})})}},{key:"menuItemHelp",value:function(){return Object(a.jsx)(m.a,{item:!0,text:"Help",children:Object(a.jsxs)(m.a.Menu,{children:[Object(a.jsx)(V,{trigger:Object(a.jsx)(m.a.Item,{children:"Usage Notes"})}),Object(a.jsx)(m.a.Divider,{}),Object(a.jsx)(m.a.Item,{disabled:!0,as:j.b,to:"/about",children:"About"})]})})}},{key:"pageBody",value:function(){return Object(a.jsxs)(g.a.Row,{columns:2,children:[Object(a.jsx)(g.a.Column,{width:11,style:{paddingRight:"5px"},children:Object(a.jsxs)(b.c,{children:[Object(a.jsx)(b.a,{exact:!0,path:"/",component:Qe}),Object(a.jsx)(b.a,{path:"/about",component:Qe}),Object(a.jsx)(b.a,{path:"/home",component:Qe}),Object(a.jsx)(b.a,{exact:!0,path:"/portfolios",component:Qe}),Object(a.jsx)(b.a,{path:"/portfolios/:id",component:ct})]})}),Object(a.jsx)(g.a.Column,{width:5,style:{paddingLeft:"5px"},children:Object(a.jsx)(M,{})})]})}},{key:"pageFooter",value:function(){return Object(a.jsx)(g.a.Row,{columns:1,children:Object(a.jsx)(g.a.Column,{children:this.pageFooterRow()})})}},{key:"pageFooterRow",value:function(){return Object(a.jsx)(O.a,{compact:!0,striped:!0,style:{marginTop:0},children:Object(a.jsx)(O.a.Header,{children:Object(a.jsx)(O.a.Row,{textAlign:"center",children:Object(a.jsx)(O.a.HeaderCell,{children:Object(a.jsxs)("span",{style:{color:"grey",textAlign:"center"},children:["\u2022 Historical data by ",Object(a.jsx)("a",{href:"https://www.alphavantage.co",target:"_blank",rel:"noopener noreferrer",children:"Alpha Vantage"}),"\u2003\u2002\u2022 Market data by ",Object(a.jsx)("a",{href:"https://iexcloud.io",target:"_blank",rel:"noopener noreferrer",children:"IEX"}),"\u2003\u2002\u2022 Headline news by ",Object(a.jsx)("a",{href:"https://newsapi.org",target:"_blank",rel:"noopener noreferrer",children:"NewsAPI.org"}),"\u2003\u2002\u2022 DJIA by ",Object(a.jsx)("a",{href:"https://finance.yahoo.com/",target:"_blank",rel:"noopener noreferrer",children:"Yahoo Finance"}),"\u2003\u2002\u2022 The prices shown may not be the correct prices or the latest prices. \u2003\u2002\u2022 See ",Object(a.jsx)(V,{trigger:Object(a.jsx)(y.a,{content:"Help->Usage Notes",className:"link",inverted:!0,size:"medium",style:{paddingLeft:"2px",paddingRight:"1px",color:"#1e70bf"}})}),"for more information."]})})})})})}},{key:"pageHeader",value:function(){return Object(a.jsx)(g.a.Row,{columns:1,children:Object(a.jsx)(g.a.Column,{stretched:!0,children:Object(a.jsx)(v.a,{src:"/images/logo.jpg"})})})}},{key:"pageMenu",value:function(){return Object(a.jsx)(g.a.Row,{columns:1,children:Object(a.jsx)(g.a.Column,{children:Object(a.jsxs)(x.a,{children:[this.pageMenuLeft(),this.pageMenuCenter(),this.pageMenuRight()]})})})}},{key:"pageMenuLeft",value:function(){return Object(a.jsx)(C.a,{className:"shadow",color:"purple",size:"large",style:{lineHeight:.75,marginRight:0,marginLeft:"1em",marginTop:".5em",marginBottom:".5em"},children:"Portfolio Analyzer"})}},{key:"pageMenuCenter",value:function(){return Object(a.jsxs)(x.a.Menu,{position:"left",children:[Object(a.jsx)(x.a.Item,{style:{padding:".8em"}}),Object(a.jsx)(x.a.Item,{as:j.b,to:"/",children:"Portfolios"}),Object(a.jsx)(bt,{})]})}},{key:"pageMenuRight",value:function(){return Object(a.jsxs)(x.a.Menu,{position:"right",children:[this.menuItemAdmin(),Object(a.jsx)(ft,{}),this.menuItemHelp()]})}},{key:"render",value:function(){return Object(a.jsx)(j.a,{children:Object(a.jsxs)(g.a,{padded:!0,stackable:!0,children:[this.pageHeader(),this.pageMenu(),this.pageBody(),this.pageFooter()]})})}}]),n}(s.Component);var gt=Object(f.b)((function(e){return{state:e}}))(mt),Ot=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function yt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var vt=n(180),xt=Object(B.c)({portfolios:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{updatingPortfolio:!1,portfolios:[],sortFn:z("name","ascending","symbol","ascending")},t=arguments.length>1?arguments[1]:void 0,n=null;switch(t.type){case Q:var r=t.payload,o=[r].concat(Object(X.a)(e.portfolios));n=Object.assign({},e,{updatingPortfolio:!1,portfolios:o});break;case $:var i=t.payload,a=e.portfolios.findIndex((function(e){return e.id===i})),s=[].concat(Object(X.a)(e.portfolios.slice(0,a)),Object(X.a)(e.portfolios.slice(a+1)));n=Object.assign({},e,{updatingPortfolio:!1,portfolios:s});break;case K:var c=t.payload,l=c.prefix,u=c.error;alert(_.serverError(l,u)),n=Object.assign({},e,{updatingPortfolio:!1});break;case Z:var d=t.payload,h=e.portfolios.findIndex((function(e){return e.id===d.id})),p=[].concat(Object(X.a)(e.portfolios.slice(0,h)),[d],Object(X.a)(e.portfolios.slice(h+1)));n=Object.assign({},e,{updatingPortfolio:!1,portfolios:p});break;case ee:var f=t.payload;n=Object.assign({},e,{updatingPortfolio:!1,portfolios:f});break;case te:n=Object.assign({},e,{updatingPortfolio:!0});break;case ne:var j=t.payload,b=j.prefix,m=j.warning;alert(_.serverError(b,m)),n=e;break;default:n=e}return n},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{updatingUser:!1,user:{locale:"en-US"}},t=arguments.length>1?arguments[1]:void 0,n=null;switch(t.type){case ue:var r=t.payload,o=r.prefix,i=r.error;alert(_.serverError(o,i)),n=Object.assign({},e,{updatingUser:!1});break;case de:var a=t.payload;n=Object.assign({},e,{updatingUser:!1,user:a.data.attributes});break;case he:n=Object.assign({},e,{updatingUser:!0});break;case pe:var s=t.payload,c=s.prefix,l=s.warning;alert(_.serverError(c,l)),n=e;break;default:n=e}return n}}),Ct=(n(223),Object(B.e)(xt,Object(B.d)(Object(B.a)(vt.a),window.devToolsExtension?window.devToolsExtension():function(e){return e})));l.a.render(Object(a.jsx)(f.a,{store:Ct,children:Object(a.jsx)(gt,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ot?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):yt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):yt(t,e)}))}}()}},[[224,1,2]]]);
//# sourceMappingURL=main.6bcda5b4.chunk.js.map